{"ast":null,"code":"import _slicedToArray from\"/Users/mingtian/chain/nitaswap-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/mingtian/chain/nitaswap-interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  border-radius: 20px;\\n  padding: 20px;\\n  border-top-left-radius: 0;\\n  border-top-right-radius: 0;\\n  background-color: \",\";\\n  border-top: 1px solid \",\";\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  flex: 1 1;\\n  position: relative;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import{ETHER}from'@uniswap/sdk';import React,{useCallback,useEffect,useMemo,useRef,useState}from'react';import ReactGA from'react-ga';import{useTranslation}from'react-i18next';import{Text}from'rebass';import{useActiveWeb3React}from'../../hooks';import{useAllTokens,useToken,useIsUserAddedToken,useFoundOnInactiveList}from'../../hooks/Tokens';import{CloseIcon,TYPE,ButtonText,IconWrapper}from'../../theme';import{isAddress}from'../../utils';import Column from'../Column';import Row,{RowBetween,RowFixed}from'../Row';import CommonBases from'./CommonBases';import CurrencyList from'./CurrencyList';import{filterTokens,useSortedTokensByQuery}from'./filtering';import{useTokenComparator}from'./sorting';import{PaddedColumn,SearchInput,Separator}from'./styleds';import AutoSizer from'react-virtualized-auto-sizer';import styled from'styled-components';import useToggle from'hooks/useToggle';import{useOnClickOutside}from'hooks/useOnClickOutside';import useTheme from'hooks/useTheme';import ImportRow from'./ImportRow';import{Edit}from'react-feather';import useDebounce from'hooks/useDebounce';var ContentWrapper=styled(Column)(_templateObject());var Footer=styled.div(_templateObject2(),function(_ref){var theme=_ref.theme;return theme.bg1;},function(_ref2){var theme=_ref2.theme;return theme.bg2;});export function CurrencySearch(_ref3){var selectedCurrency=_ref3.selectedCurrency,onCurrencySelect=_ref3.onCurrencySelect,otherSelectedCurrency=_ref3.otherSelectedCurrency,showCommonBases=_ref3.showCommonBases,onDismiss=_ref3.onDismiss,isOpen=_ref3.isOpen,showManageView=_ref3.showManageView,showImportView=_ref3.showImportView,setImportToken=_ref3.setImportToken;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useActiveWeb3React=useActiveWeb3React(),chainId=_useActiveWeb3React.chainId;var theme=useTheme();// refs for fixed size lists\nvar fixedList=useRef();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),searchQuery=_useState2[0],setSearchQuery=_useState2[1];var debouncedQuery=useDebounce(searchQuery,200);var _useState3=useState(false),_useState4=_slicedToArray(_useState3,1),invertSearchOrder=_useState4[0];var allTokens=useAllTokens();// if they input an address, use it\nvar isAddressSearch=isAddress(debouncedQuery);var searchToken=useToken(debouncedQuery);var searchTokenIsAdded=useIsUserAddedToken(searchToken);useEffect(function(){if(isAddressSearch){ReactGA.event({category:'Currency Select',action:'Search by address',label:isAddressSearch});}},[isAddressSearch]);var showETH=useMemo(function(){var s=debouncedQuery.toLowerCase().trim();return s===''||s==='e'||s==='et'||s==='eth';},[debouncedQuery]);var tokenComparator=useTokenComparator(invertSearchOrder);var filteredTokens=useMemo(function(){return filterTokens(Object.values(allTokens),debouncedQuery);},[allTokens,debouncedQuery]);var sortedTokens=useMemo(function(){return filteredTokens.sort(tokenComparator);},[filteredTokens,tokenComparator]);var filteredSortedTokens=useSortedTokensByQuery(sortedTokens,debouncedQuery);var handleCurrencySelect=useCallback(function(currency){onCurrencySelect(currency);onDismiss();},[onDismiss,onCurrencySelect]);// clear the input on open\nuseEffect(function(){if(isOpen)setSearchQuery('');},[isOpen]);// manage focus on modal show\nvar inputRef=useRef();var handleInput=useCallback(function(event){var _fixedList$current;var input=event.target.value;var checksummedInput=isAddress(input);setSearchQuery(checksummedInput||input);(_fixedList$current=fixedList.current)===null||_fixedList$current===void 0?void 0:_fixedList$current.scrollTo(0);},[]);var handleEnter=useCallback(function(e){if(e.key==='Enter'){var s=debouncedQuery.toLowerCase().trim();if(s==='eth'){handleCurrencySelect(ETHER);}else if(filteredSortedTokens.length>0){var _filteredSortedTokens;if(((_filteredSortedTokens=filteredSortedTokens[0].symbol)===null||_filteredSortedTokens===void 0?void 0:_filteredSortedTokens.toLowerCase())===debouncedQuery.trim().toLowerCase()||filteredSortedTokens.length===1){handleCurrencySelect(filteredSortedTokens[0]);}}}},[filteredSortedTokens,handleCurrencySelect,debouncedQuery]);// menu ui\nvar _useToggle=useToggle(false),_useToggle2=_slicedToArray(_useToggle,2),open=_useToggle2[0],toggle=_useToggle2[1];var node=useRef();useOnClickOutside(node,open?toggle:undefined);// if no results on main list, show option to expand into inactive\nvar inactiveTokens=useFoundOnInactiveList(debouncedQuery);var filteredInactiveTokens=useSortedTokensByQuery(inactiveTokens,debouncedQuery);return/*#__PURE__*/React.createElement(ContentWrapper,null,/*#__PURE__*/React.createElement(PaddedColumn,{gap:\"16px\"},/*#__PURE__*/React.createElement(RowBetween,null,/*#__PURE__*/React.createElement(Text,{fontWeight:500,fontSize:16},\"Select a token\"),/*#__PURE__*/React.createElement(CloseIcon,{onClick:onDismiss})),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(SearchInput,{type:\"text\",id:\"token-search-input\",placeholder:t('tokenSearchPlaceholder'),autoComplete:\"off\",value:searchQuery,ref:inputRef,onChange:handleInput,onKeyDown:handleEnter})),showCommonBases&&/*#__PURE__*/React.createElement(CommonBases,{chainId:chainId,onSelect:handleCurrencySelect,selectedCurrency:selectedCurrency})),/*#__PURE__*/React.createElement(Separator,null),searchToken&&!searchTokenIsAdded?/*#__PURE__*/React.createElement(Column,{style:{padding:'20px 0',height:'100%'}},/*#__PURE__*/React.createElement(ImportRow,{token:searchToken,showImportView:showImportView,setImportToken:setImportToken})):(filteredSortedTokens===null||filteredSortedTokens===void 0?void 0:filteredSortedTokens.length)>0||(filteredInactiveTokens===null||filteredInactiveTokens===void 0?void 0:filteredInactiveTokens.length)>0?/*#__PURE__*/React.createElement(\"div\",{style:{flex:'1'}},/*#__PURE__*/React.createElement(AutoSizer,{disableWidth:true},function(_ref4){var height=_ref4.height;return/*#__PURE__*/React.createElement(CurrencyList,{height:height,showETH:showETH,currencies:filteredInactiveTokens?filteredSortedTokens.concat(filteredInactiveTokens):filteredSortedTokens,breakIndex:inactiveTokens&&filteredSortedTokens?filteredSortedTokens.length:undefined,onCurrencySelect:handleCurrencySelect,otherCurrency:otherSelectedCurrency,selectedCurrency:selectedCurrency,fixedListRef:fixedList,showImportView:showImportView,setImportToken:setImportToken});})):/*#__PURE__*/React.createElement(Column,{style:{padding:'20px',height:'100%'}},/*#__PURE__*/React.createElement(TYPE.main,{color:theme.text3,textAlign:\"center\",mb:\"20px\"},\"No results found.\")),/*#__PURE__*/React.createElement(Footer,null,/*#__PURE__*/React.createElement(Row,{justify:\"center\"},/*#__PURE__*/React.createElement(ButtonText,{onClick:showManageView,color:theme.blue1,className:\"list-token-manage-button\"},/*#__PURE__*/React.createElement(RowFixed,null,/*#__PURE__*/React.createElement(IconWrapper,{size:\"16px\",marginRight:\"6px\"},/*#__PURE__*/React.createElement(Edit,null)),/*#__PURE__*/React.createElement(TYPE.main,{color:theme.blue1},\"Manage\"))))));}","map":{"version":3,"sources":["/Users/mingtian/chain/nitaswap-interface/src/components/SearchModal/CurrencySearch.tsx"],"names":["ETHER","React","useCallback","useEffect","useMemo","useRef","useState","ReactGA","useTranslation","Text","useActiveWeb3React","useAllTokens","useToken","useIsUserAddedToken","useFoundOnInactiveList","CloseIcon","TYPE","ButtonText","IconWrapper","isAddress","Column","Row","RowBetween","RowFixed","CommonBases","CurrencyList","filterTokens","useSortedTokensByQuery","useTokenComparator","PaddedColumn","SearchInput","Separator","AutoSizer","styled","useToggle","useOnClickOutside","useTheme","ImportRow","Edit","useDebounce","ContentWrapper","Footer","div","theme","bg1","bg2","CurrencySearch","selectedCurrency","onCurrencySelect","otherSelectedCurrency","showCommonBases","onDismiss","isOpen","showManageView","showImportView","setImportToken","t","chainId","fixedList","searchQuery","setSearchQuery","debouncedQuery","invertSearchOrder","allTokens","isAddressSearch","searchToken","searchTokenIsAdded","event","category","action","label","showETH","s","toLowerCase","trim","tokenComparator","filteredTokens","Object","values","sortedTokens","sort","filteredSortedTokens","handleCurrencySelect","currency","inputRef","handleInput","input","target","value","checksummedInput","current","scrollTo","handleEnter","e","key","length","symbol","open","toggle","node","undefined","inactiveTokens","filteredInactiveTokens","padding","height","flex","concat","text3","blue1"],"mappings":"u0BAAA,OAAmBA,KAAnB,KAAuC,cAAvC,CACA,MAAOC,CAAAA,KAAP,EAA0CC,WAA1C,CAAuDC,SAAvD,CAAkEC,OAAlE,CAA2EC,MAA3E,CAAmFC,QAAnF,KAAmG,OAAnG,CACA,MAAOC,CAAAA,OAAP,KAAoB,UAApB,CACA,OAASC,cAAT,KAA+B,eAA/B,CAEA,OAASC,IAAT,KAAqB,QAArB,CACA,OAASC,kBAAT,KAAmC,aAAnC,CACA,OAASC,YAAT,CAAuBC,QAAvB,CAAiCC,mBAAjC,CAAsDC,sBAAtD,KAAoF,oBAApF,CACA,OAASC,SAAT,CAAoBC,IAApB,CAA0BC,UAA1B,CAAsCC,WAAtC,KAAyD,aAAzD,CACA,OAASC,SAAT,KAA0B,aAA1B,CACA,MAAOC,CAAAA,MAAP,KAAmB,WAAnB,CACA,MAAOC,CAAAA,GAAP,EAAcC,UAAd,CAA0BC,QAA1B,KAA0C,QAA1C,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CACA,MAAOC,CAAAA,YAAP,KAAyB,gBAAzB,CACA,OAASC,YAAT,CAAuBC,sBAAvB,KAAqD,aAArD,CACA,OAASC,kBAAT,KAAmC,WAAnC,CACA,OAASC,YAAT,CAAuBC,WAAvB,CAAoCC,SAApC,KAAqD,WAArD,CACA,MAAOC,CAAAA,SAAP,KAAsB,8BAAtB,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,MAAOC,CAAAA,SAAP,KAAsB,iBAAtB,CACA,OAASC,iBAAT,KAAkC,yBAAlC,CACA,MAAOC,CAAAA,QAAP,KAAqB,gBAArB,CACA,MAAOC,CAAAA,SAAP,KAAsB,aAAtB,CACA,OAASC,IAAT,KAAqB,eAArB,CACA,MAAOC,CAAAA,WAAP,KAAwB,mBAAxB,CAEA,GAAMC,CAAAA,cAAc,CAAGP,MAAM,CAACb,MAAD,CAAT,mBAApB,CAMA,GAAMqB,CAAAA,MAAM,CAAGR,MAAM,CAACS,GAAV,oBAMU,kBAAGC,CAAAA,KAAH,MAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACC,GAArB,EANV,CAOc,mBAAGD,CAAAA,KAAH,OAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACE,GAArB,EAPd,CAAZ,CAsBA,MAAO,SAASC,CAAAA,cAAT,OAUiB,IATtBC,CAAAA,gBASsB,OATtBA,gBASsB,CARtBC,gBAQsB,OARtBA,gBAQsB,CAPtBC,qBAOsB,OAPtBA,qBAOsB,CANtBC,eAMsB,OANtBA,eAMsB,CALtBC,SAKsB,OALtBA,SAKsB,CAJtBC,MAIsB,OAJtBA,MAIsB,CAHtBC,cAGsB,OAHtBA,cAGsB,CAFtBC,cAEsB,OAFtBA,cAEsB,CADtBC,cACsB,OADtBA,cACsB,qBACR/C,cAAc,EADN,CACdgD,CADc,iBACdA,CADc,yBAEF9C,kBAAkB,EAFhB,CAEd+C,OAFc,qBAEdA,OAFc,CAGtB,GAAMd,CAAAA,KAAK,CAAGP,QAAQ,EAAtB,CAEA;AACA,GAAMsB,CAAAA,SAAS,CAAGrD,MAAM,EAAxB,CANsB,cAQgBC,QAAQ,CAAS,EAAT,CARxB,wCAQfqD,WARe,eAQFC,cARE,eAStB,GAAMC,CAAAA,cAAc,CAAGtB,WAAW,CAACoB,WAAD,CAAc,GAAd,CAAlC,CATsB,eAWMrD,QAAQ,CAAU,KAAV,CAXd,yCAWfwD,iBAXe,eAatB,GAAMC,CAAAA,SAAS,CAAGpD,YAAY,EAA9B,CAEA;AACA,GAAMqD,CAAAA,eAAe,CAAG7C,SAAS,CAAC0C,cAAD,CAAjC,CACA,GAAMI,CAAAA,WAAW,CAAGrD,QAAQ,CAACiD,cAAD,CAA5B,CACA,GAAMK,CAAAA,kBAAkB,CAAGrD,mBAAmB,CAACoD,WAAD,CAA9C,CAEA9D,SAAS,CAAC,UAAM,CACd,GAAI6D,eAAJ,CAAqB,CACnBzD,OAAO,CAAC4D,KAAR,CAAc,CACZC,QAAQ,CAAE,iBADE,CAEZC,MAAM,CAAE,mBAFI,CAGZC,KAAK,CAAEN,eAHK,CAAd,EAKD,CACF,CARQ,CAQN,CAACA,eAAD,CARM,CAAT,CAUA,GAAMO,CAAAA,OAAgB,CAAGnE,OAAO,CAAC,UAAM,CACrC,GAAMoE,CAAAA,CAAC,CAAGX,cAAc,CAACY,WAAf,GAA6BC,IAA7B,EAAV,CACA,MAAOF,CAAAA,CAAC,GAAK,EAAN,EAAYA,CAAC,GAAK,GAAlB,EAAyBA,CAAC,GAAK,IAA/B,EAAuCA,CAAC,GAAK,KAApD,CACD,CAH+B,CAG7B,CAACX,cAAD,CAH6B,CAAhC,CAKA,GAAMc,CAAAA,eAAe,CAAG/C,kBAAkB,CAACkC,iBAAD,CAA1C,CAEA,GAAMc,CAAAA,cAAuB,CAAGxE,OAAO,CAAC,UAAM,CAC5C,MAAOsB,CAAAA,YAAY,CAACmD,MAAM,CAACC,MAAP,CAAcf,SAAd,CAAD,CAA2BF,cAA3B,CAAnB,CACD,CAFsC,CAEpC,CAACE,SAAD,CAAYF,cAAZ,CAFoC,CAAvC,CAIA,GAAMkB,CAAAA,YAAqB,CAAG3E,OAAO,CAAC,UAAM,CAC1C,MAAOwE,CAAAA,cAAc,CAACI,IAAf,CAAoBL,eAApB,CAAP,CACD,CAFoC,CAElC,CAACC,cAAD,CAAiBD,eAAjB,CAFkC,CAArC,CAIA,GAAMM,CAAAA,oBAAoB,CAAGtD,sBAAsB,CAACoD,YAAD,CAAelB,cAAf,CAAnD,CAEA,GAAMqB,CAAAA,oBAAoB,CAAGhF,WAAW,CACtC,SAACiF,QAAD,CAAwB,CACtBnC,gBAAgB,CAACmC,QAAD,CAAhB,CACAhC,SAAS,GACV,CAJqC,CAKtC,CAACA,SAAD,CAAYH,gBAAZ,CALsC,CAAxC,CAQA;AACA7C,SAAS,CAAC,UAAM,CACd,GAAIiD,MAAJ,CAAYQ,cAAc,CAAC,EAAD,CAAd,CACb,CAFQ,CAEN,CAACR,MAAD,CAFM,CAAT,CAIA;AACA,GAAMgC,CAAAA,QAAQ,CAAG/E,MAAM,EAAvB,CACA,GAAMgF,CAAAA,WAAW,CAAGnF,WAAW,CAAC,SAAAiE,KAAK,CAAI,wBACvC,GAAMmB,CAAAA,KAAK,CAAGnB,KAAK,CAACoB,MAAN,CAAaC,KAA3B,CACA,GAAMC,CAAAA,gBAAgB,CAAGtE,SAAS,CAACmE,KAAD,CAAlC,CACA1B,cAAc,CAAC6B,gBAAgB,EAAIH,KAArB,CAAd,CACA,oBAAA5B,SAAS,CAACgC,OAAV,gEAAmBC,QAAnB,CAA4B,CAA5B,EACD,CAL8B,CAK5B,EAL4B,CAA/B,CAOA,GAAMC,CAAAA,WAAW,CAAG1F,WAAW,CAC7B,SAAC2F,CAAD,CAAwC,CACtC,GAAIA,CAAC,CAACC,GAAF,GAAU,OAAd,CAAuB,CACrB,GAAMtB,CAAAA,CAAC,CAAGX,cAAc,CAACY,WAAf,GAA6BC,IAA7B,EAAV,CACA,GAAIF,CAAC,GAAK,KAAV,CAAiB,CACfU,oBAAoB,CAAClF,KAAD,CAApB,CACD,CAFD,IAEO,IAAIiF,oBAAoB,CAACc,MAArB,CAA8B,CAAlC,CAAqC,2BAC1C,GACE,wBAAAd,oBAAoB,CAAC,CAAD,CAApB,CAAwBe,MAAxB,sEAAgCvB,WAAhC,MAAkDZ,cAAc,CAACa,IAAf,GAAsBD,WAAtB,EAAlD,EACAQ,oBAAoB,CAACc,MAArB,GAAgC,CAFlC,CAGE,CACAb,oBAAoB,CAACD,oBAAoB,CAAC,CAAD,CAArB,CAApB,CACD,CACF,CACF,CACF,CAf4B,CAgB7B,CAACA,oBAAD,CAAuBC,oBAAvB,CAA6CrB,cAA7C,CAhB6B,CAA/B,CAmBA;AAxFsB,eAyFC3B,SAAS,CAAC,KAAD,CAzFV,0CAyFf+D,IAzFe,gBAyFTC,MAzFS,gBA0FtB,GAAMC,CAAAA,IAAI,CAAG9F,MAAM,EAAnB,CACA8B,iBAAiB,CAACgE,IAAD,CAAOF,IAAI,CAAGC,MAAH,CAAYE,SAAvB,CAAjB,CAEA;AACA,GAAMC,CAAAA,cAAc,CAAGvF,sBAAsB,CAAC+C,cAAD,CAA7C,CACA,GAAMyC,CAAAA,sBAA+B,CAAG3E,sBAAsB,CAAC0E,cAAD,CAAiBxC,cAAjB,CAA9D,CAEA,mBACE,oBAAC,cAAD,mBACE,oBAAC,YAAD,EAAc,GAAG,CAAC,MAAlB,eACE,oBAAC,UAAD,mBACE,oBAAC,IAAD,EAAM,UAAU,CAAE,GAAlB,CAAuB,QAAQ,CAAE,EAAjC,mBADF,cAIE,oBAAC,SAAD,EAAW,OAAO,CAAEV,SAApB,EAJF,CADF,cAOE,oBAAC,GAAD,mBACE,oBAAC,WAAD,EACE,IAAI,CAAC,MADP,CAEE,EAAE,CAAC,oBAFL,CAGE,WAAW,CAAEK,CAAC,CAAC,wBAAD,CAHhB,CAIE,YAAY,CAAC,KAJf,CAKE,KAAK,CAAEG,WALT,CAME,GAAG,CAAEyB,QANP,CAOE,QAAQ,CAAEC,WAPZ,CAQE,SAAS,CAAEO,WARb,EADF,CAPF,CAmBG1C,eAAe,eACd,oBAAC,WAAD,EAAa,OAAO,CAAEO,OAAtB,CAA+B,QAAQ,CAAEyB,oBAAzC,CAA+D,gBAAgB,CAAEnC,gBAAjF,EApBJ,CADF,cAwBE,oBAAC,SAAD,MAxBF,CAyBGkB,WAAW,EAAI,CAACC,kBAAhB,cACC,oBAAC,MAAD,EAAQ,KAAK,CAAE,CAAEqC,OAAO,CAAE,QAAX,CAAqBC,MAAM,CAAE,MAA7B,CAAf,eACE,oBAAC,SAAD,EAAW,KAAK,CAAEvC,WAAlB,CAA+B,cAAc,CAAEX,cAA/C,CAA+D,cAAc,CAAEC,cAA/E,EADF,CADD,CAIG,CAAA0B,oBAAoB,OAApB,EAAAA,oBAAoB,SAApB,QAAAA,oBAAoB,CAAEc,MAAtB,EAA+B,CAA/B,EAAoC,CAAAO,sBAAsB,OAAtB,EAAAA,sBAAsB,SAAtB,QAAAA,sBAAsB,CAAEP,MAAxB,EAAiC,CAArE,cACF,2BAAK,KAAK,CAAE,CAAEU,IAAI,CAAE,GAAR,CAAZ,eACE,oBAAC,SAAD,EAAW,YAAY,KAAvB,EACG,mBAAGD,CAAAA,MAAH,OAAGA,MAAH,oBACC,oBAAC,YAAD,EACE,MAAM,CAAEA,MADV,CAEE,OAAO,CAAEjC,OAFX,CAGE,UAAU,CACR+B,sBAAsB,CAAGrB,oBAAoB,CAACyB,MAArB,CAA4BJ,sBAA5B,CAAH,CAAyDrB,oBAJnF,CAME,UAAU,CAAEoB,cAAc,EAAIpB,oBAAlB,CAAyCA,oBAAoB,CAACc,MAA9D,CAAuEK,SANrF,CAOE,gBAAgB,CAAElB,oBAPpB,CAQE,aAAa,CAAEjC,qBARjB,CASE,gBAAgB,CAAEF,gBATpB,CAUE,YAAY,CAAEW,SAVhB,CAWE,cAAc,CAAEJ,cAXlB,CAYE,cAAc,CAAEC,cAZlB,EADD,EADH,CADF,CADE,cAsBF,oBAAC,MAAD,EAAQ,KAAK,CAAE,CAAEgD,OAAO,CAAE,MAAX,CAAmBC,MAAM,CAAE,MAA3B,CAAf,eACE,oBAAC,IAAD,CAAM,IAAN,EAAW,KAAK,CAAE7D,KAAK,CAACgE,KAAxB,CAA+B,SAAS,CAAC,QAAzC,CAAkD,EAAE,CAAC,MAArD,sBADF,CAnDJ,cAyDE,oBAAC,MAAD,mBACE,oBAAC,GAAD,EAAK,OAAO,CAAC,QAAb,eACE,oBAAC,UAAD,EAAY,OAAO,CAAEtD,cAArB,CAAqC,KAAK,CAAEV,KAAK,CAACiE,KAAlD,CAAyD,SAAS,CAAC,0BAAnE,eACE,oBAAC,QAAD,mBACE,oBAAC,WAAD,EAAa,IAAI,CAAC,MAAlB,CAAyB,WAAW,CAAC,KAArC,eACE,oBAAC,IAAD,MADF,CADF,cAIE,oBAAC,IAAD,CAAM,IAAN,EAAW,KAAK,CAAEjE,KAAK,CAACiE,KAAxB,WAJF,CADF,CADF,CADF,CAzDF,CADF,CAwED","sourcesContent":["import { Currency, ETHER, Token } from '@uniswap/sdk'\nimport React, { KeyboardEvent, RefObject, useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport ReactGA from 'react-ga'\nimport { useTranslation } from 'react-i18next'\nimport { FixedSizeList } from 'react-window'\nimport { Text } from 'rebass'\nimport { useActiveWeb3React } from '../../hooks'\nimport { useAllTokens, useToken, useIsUserAddedToken, useFoundOnInactiveList } from '../../hooks/Tokens'\nimport { CloseIcon, TYPE, ButtonText, IconWrapper } from '../../theme'\nimport { isAddress } from '../../utils'\nimport Column from '../Column'\nimport Row, { RowBetween, RowFixed } from '../Row'\nimport CommonBases from './CommonBases'\nimport CurrencyList from './CurrencyList'\nimport { filterTokens, useSortedTokensByQuery } from './filtering'\nimport { useTokenComparator } from './sorting'\nimport { PaddedColumn, SearchInput, Separator } from './styleds'\nimport AutoSizer from 'react-virtualized-auto-sizer'\nimport styled from 'styled-components'\nimport useToggle from 'hooks/useToggle'\nimport { useOnClickOutside } from 'hooks/useOnClickOutside'\nimport useTheme from 'hooks/useTheme'\nimport ImportRow from './ImportRow'\nimport { Edit } from 'react-feather'\nimport useDebounce from 'hooks/useDebounce'\n\nconst ContentWrapper = styled(Column)`\n  width: 100%;\n  flex: 1 1;\n  position: relative;\n`\n\nconst Footer = styled.div`\n  width: 100%;\n  border-radius: 20px;\n  padding: 20px;\n  border-top-left-radius: 0;\n  border-top-right-radius: 0;\n  background-color: ${({ theme }) => theme.bg1};\n  border-top: 1px solid ${({ theme }) => theme.bg2};\n`\n\ninterface CurrencySearchProps {\n  isOpen: boolean\n  onDismiss: () => void\n  selectedCurrency?: Currency | null\n  onCurrencySelect: (currency: Currency) => void\n  otherSelectedCurrency?: Currency | null\n  showCommonBases?: boolean\n  showManageView: () => void\n  showImportView: () => void\n  setImportToken: (token: Token) => void\n}\n\nexport function CurrencySearch({\n  selectedCurrency,\n  onCurrencySelect,\n  otherSelectedCurrency,\n  showCommonBases,\n  onDismiss,\n  isOpen,\n  showManageView,\n  showImportView,\n  setImportToken\n}: CurrencySearchProps) {\n  const { t } = useTranslation()\n  const { chainId } = useActiveWeb3React()\n  const theme = useTheme()\n\n  // refs for fixed size lists\n  const fixedList = useRef<FixedSizeList>()\n\n  const [searchQuery, setSearchQuery] = useState<string>('')\n  const debouncedQuery = useDebounce(searchQuery, 200)\n\n  const [invertSearchOrder] = useState<boolean>(false)\n\n  const allTokens = useAllTokens()\n\n  // if they input an address, use it\n  const isAddressSearch = isAddress(debouncedQuery)\n  const searchToken = useToken(debouncedQuery)\n  const searchTokenIsAdded = useIsUserAddedToken(searchToken)\n\n  useEffect(() => {\n    if (isAddressSearch) {\n      ReactGA.event({\n        category: 'Currency Select',\n        action: 'Search by address',\n        label: isAddressSearch\n      })\n    }\n  }, [isAddressSearch])\n\n  const showETH: boolean = useMemo(() => {\n    const s = debouncedQuery.toLowerCase().trim()\n    return s === '' || s === 'e' || s === 'et' || s === 'eth'\n  }, [debouncedQuery])\n\n  const tokenComparator = useTokenComparator(invertSearchOrder)\n\n  const filteredTokens: Token[] = useMemo(() => {\n    return filterTokens(Object.values(allTokens), debouncedQuery)\n  }, [allTokens, debouncedQuery])\n\n  const sortedTokens: Token[] = useMemo(() => {\n    return filteredTokens.sort(tokenComparator)\n  }, [filteredTokens, tokenComparator])\n\n  const filteredSortedTokens = useSortedTokensByQuery(sortedTokens, debouncedQuery)\n\n  const handleCurrencySelect = useCallback(\n    (currency: Currency) => {\n      onCurrencySelect(currency)\n      onDismiss()\n    },\n    [onDismiss, onCurrencySelect]\n  )\n\n  // clear the input on open\n  useEffect(() => {\n    if (isOpen) setSearchQuery('')\n  }, [isOpen])\n\n  // manage focus on modal show\n  const inputRef = useRef<HTMLInputElement>()\n  const handleInput = useCallback(event => {\n    const input = event.target.value\n    const checksummedInput = isAddress(input)\n    setSearchQuery(checksummedInput || input)\n    fixedList.current?.scrollTo(0)\n  }, [])\n\n  const handleEnter = useCallback(\n    (e: KeyboardEvent<HTMLInputElement>) => {\n      if (e.key === 'Enter') {\n        const s = debouncedQuery.toLowerCase().trim()\n        if (s === 'eth') {\n          handleCurrencySelect(ETHER)\n        } else if (filteredSortedTokens.length > 0) {\n          if (\n            filteredSortedTokens[0].symbol?.toLowerCase() === debouncedQuery.trim().toLowerCase() ||\n            filteredSortedTokens.length === 1\n          ) {\n            handleCurrencySelect(filteredSortedTokens[0])\n          }\n        }\n      }\n    },\n    [filteredSortedTokens, handleCurrencySelect, debouncedQuery]\n  )\n\n  // menu ui\n  const [open, toggle] = useToggle(false)\n  const node = useRef<HTMLDivElement>()\n  useOnClickOutside(node, open ? toggle : undefined)\n\n  // if no results on main list, show option to expand into inactive\n  const inactiveTokens = useFoundOnInactiveList(debouncedQuery)\n  const filteredInactiveTokens: Token[] = useSortedTokensByQuery(inactiveTokens, debouncedQuery)\n\n  return (\n    <ContentWrapper>\n      <PaddedColumn gap=\"16px\">\n        <RowBetween>\n          <Text fontWeight={500} fontSize={16}>\n            Select a token\n          </Text>\n          <CloseIcon onClick={onDismiss} />\n        </RowBetween>\n        <Row>\n          <SearchInput\n            type=\"text\"\n            id=\"token-search-input\"\n            placeholder={t('tokenSearchPlaceholder')}\n            autoComplete=\"off\"\n            value={searchQuery}\n            ref={inputRef as RefObject<HTMLInputElement>}\n            onChange={handleInput}\n            onKeyDown={handleEnter}\n          />\n        </Row>\n        {showCommonBases && (\n          <CommonBases chainId={chainId} onSelect={handleCurrencySelect} selectedCurrency={selectedCurrency} />\n        )}\n      </PaddedColumn>\n      <Separator />\n      {searchToken && !searchTokenIsAdded ? (\n        <Column style={{ padding: '20px 0', height: '100%' }}>\n          <ImportRow token={searchToken} showImportView={showImportView} setImportToken={setImportToken} />\n        </Column>\n      ) : filteredSortedTokens?.length > 0 || filteredInactiveTokens?.length > 0 ? (\n        <div style={{ flex: '1' }}>\n          <AutoSizer disableWidth>\n            {({ height }) => (\n              <CurrencyList\n                height={height}\n                showETH={showETH}\n                currencies={\n                  filteredInactiveTokens ? filteredSortedTokens.concat(filteredInactiveTokens) : filteredSortedTokens\n                }\n                breakIndex={inactiveTokens && filteredSortedTokens ? filteredSortedTokens.length : undefined}\n                onCurrencySelect={handleCurrencySelect}\n                otherCurrency={otherSelectedCurrency}\n                selectedCurrency={selectedCurrency}\n                fixedListRef={fixedList}\n                showImportView={showImportView}\n                setImportToken={setImportToken}\n              />\n            )}\n          </AutoSizer>\n        </div>\n      ) : (\n        <Column style={{ padding: '20px', height: '100%' }}>\n          <TYPE.main color={theme.text3} textAlign=\"center\" mb=\"20px\">\n            No results found.\n          </TYPE.main>\n        </Column>\n      )}\n      <Footer>\n        <Row justify=\"center\">\n          <ButtonText onClick={showManageView} color={theme.blue1} className=\"list-token-manage-button\">\n            <RowFixed>\n              <IconWrapper size=\"16px\" marginRight=\"6px\">\n                <Edit />\n              </IconWrapper>\n              <TYPE.main color={theme.blue1}>Manage</TYPE.main>\n            </RowFixed>\n          </ButtonText>\n        </Row>\n      </Footer>\n    </ContentWrapper>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}